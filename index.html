<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <title>ร้านเสริมสวยมุกซาลอน</title>
    <link href="https://fonts.googleapis.com/css2?family=Itim&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * {
            font-family: 'Itim', cursive;
            font-size: 18px;
        }

        body {
            background: linear-gradient(135deg, #ffd6e7 0%, #c8f4ff 100%);
            margin: 0;
            padding: 0;
            background-size: cover;
            background-position: center;
            font-size: 18px;
            line-height: 1.6;
            position: relative;
            min-height: 100vh;
            overflow-x: hidden;
        }

        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect fill-opacity="0.05" fill="white" width="50" height="50" /><rect fill-opacity="0.05" fill="white" x="50" y="50" width="50" height="50" /></svg>');
            z-index: -1;
        }

        header {
            background: rgba(233, 235, 213, 0.8);
            color: white;
            text-align: center;
            padding: 20px;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 30px rgba(95, 95, 95, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header-content {
            flex: 1;
            text-align: center;
        }

        .header-content h1 {
            font-size: 2.2rem;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(112, 112, 112, 0.411);
            background: linear-gradient(45deg, #9ea0ff, #000000e8, #33b5d6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 5s ease infinite;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        nav {
            display: flex;
            justify-content: center;
            background: rgba(208, 204, 255, 0.9);
            padding: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
        }

        nav button {
            background: rgba(255, 255, 255, 0.3);
            border: none;
            padding: 15px 25px;
            margin: 0 5px;
            cursor: pointer;
            font-weight: bold;
            color: #000000;
            font-size: 1.1rem;
            border-radius: 50px;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        nav button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            transition: all 0.5s ease;
        }

        nav button:hover::before {
            left: 100%;
        }

        nav button:hover {
            background: rgba(255, 255, 255, 0.5);
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }

        nav button.active {
            background: rgba(255, 102, 102, 0.7);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 102, 102, 0.4);
        }

        .page {
            display: none;
            padding: 20px;
            text-align: center;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .activePage {
            display: block;
        }

        .box {
            background: rgba(255, 255, 255, 0.7);
            padding: 25px;
            margin: 20px auto;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            font-size: 1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .box::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            z-index: -1;
            background: linear-gradient(45deg, #9eb5ff, #7566ff, #33a8d6, #c8f4ff);
            background-size: 400% 400%;
            animation: gradientBorder 6s ease infinite;
            border-radius: 25px;
            opacity: 0.3;
            filter: blur(15px);
        }

        @keyframes gradientBorder {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .box:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        input,
        select,
        button,
        textarea {
            margin: 10px 0;
            padding: 14px;
            width: 90%;
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.8);
            font-size: 1rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border-color: #ff9ecb;
        }

        button {
            background: linear-gradient(45deg, #33d641, #2bc437);
            color: white;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 12px;
            padding: 14px 20px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(51, 214, 65, 0.3);
            position: relative;
            overflow: hidden;
        }

        button::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(255, 255, 255, 0.2), transparent);
            transform: translateY(-100%);
            transition: transform 0.3s ease;
        }

        button:hover::after {
            transform: translateY(0);
        }

        button:hover {
            background: linear-gradient(45deg, #2bc437, #25a82f);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(51, 214, 65, 0.4);
        }

        .stars span {
            font-size: 32px;
            cursor: pointer;
            color: #ddd;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            margin: 0 3px;
            user-select: none;
        }

        .stars span:hover {
            transform: scale(1.2);
        }

        .stars span.active {
            color: gold;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
        }

        img {
            max-width: 100%;
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
        }

        img:hover {
            transform: scale(1.02);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.2);
        }

        .message {
            font-size: 1.3rem;
            font-weight: bold;
            color: #000000;
            margin-top: 20px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .admin-only {
            display: none;
        }

        .logged-in .admin-only {
            display: block;
        }

        .review-item {
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.5);
            padding: 15px;
            background: rgba(255, 255, 255, 0.6);
            margin: 10px 0;
            border-radius: 15px;
            backdrop-filter: blur(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .review-item:hover {
            background: rgba(255, 255, 255, 0.8);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .review-name {
            font-weight: bold;
            font-size: 1.1rem;
            color: #ff6666;
        }

        .review-stars {
            color: gold;
            font-size: 1.2rem;
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
        }

        .login-btn {
            background: linear-gradient(45deg, #ff3333, #ff6666);
            color: white;
            padding: 12px 20px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1rem;
            box-shadow: 0 4px 15px rgba(255, 51, 51, 0.3);
            transition: all 0.3s ease;
        }

        .login-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 51, 51, 0.4);
        }

        .logout-btn {
            background: #ff3333;
            margin-left: 10px;
        }

        .line-icon {
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            color: #ff3333;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .admin-panel {
            position: absolute;
            right: 15px;
            top: 15px;
            display: flex;
            align-items: center;
        }

        .review-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .review-modal-content {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            font-size: 1.1rem;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
            animation: modalAppear 0.4s ease;
        }

        @keyframes modalAppear {
            from { opacity: 0; transform: scale(0.9) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .delete-btn {
            background: linear-gradient(45deg, #ff3333, #ff6666);
            margin-left: 10px;
            padding: 8px 15px;
            font-size: 0.9rem;
            border-radius: 8px;
        }

        .service-item,
        .holiday-item,
        .promo-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 8px 0;
            padding: 12px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 12px;
            font-size: 1rem;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }

        .service-item:hover,
        .holiday-item:hover,
        .promo-item:hover {
            background: rgba(255, 255, 255, 0.8);
            transform: translateX(5px);
        }

        .promo-item {
            background: rgba(255, 255, 255, 0.7);
            padding: 18px;
            margin: 12px 0;
            border-radius: 15px;
            flex-direction: column;
            align-items: flex-start;
        }

        .booking-item {
            background: rgba(255, 255, 255, 0.7);
            padding: 20px;
            margin: 12px 0;
            border-radius: 15px;
            font-size: 1rem;
            backdrop-filter: blur(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }

        .booking-item:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }

        #holidayList li,
        #servicesList li {
            background: rgba(255, 255, 255, 0.6);
            padding: 12px;
            border-radius: 12px;
            margin: 8px 0;
            font-size: 1rem;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }

        #holidayList li:hover,
        #servicesList li:hover {
            background: rgba(255, 255, 255, 0.8);
            transform: translateX(5px);
        }

        .line-config {
            background: rgba(255, 255, 255, 0.9);
            padding: 25px;
            border-radius: 15px;
            margin: 15px 0;
            font-size: 1rem;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .test-result {
            margin-top: 12px;
            padding: 15px;
            border-radius: 10px;
            display: none;
            font-size: 1rem;
            backdrop-filter: blur(5px);
        }

        .success {
            background: rgba(212, 237, 218, 0.8);
            color: #155724;
            border: 1px solid rgba(195, 230, 203, 0.7);
        }

        .error {
            background: rgba(248, 215, 218, 0.8);
            color: #721c24;
            border: 1px solid rgba(245, 198, 203, 0.7);
        }

        .config-section {
            text-align: left;
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .instructions {
            background: rgba(231, 243, 255, 0.8);
            padding: 20px;
            border-radius: 15px;
            margin: 15px 0;
            text-align: left;
            font-size: 1rem;
            backdrop-filter: blur(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .instructions ol {
            padding-left: 20px;
        }

        .instructions li {
            margin-bottom: 12px;
            font-size: 1rem;
        }

        .qr-code {
            text-align: center;
            margin: 15px 0;
        }

        .qr-code img {
            max-width: 200px;
            border: 1px solid #ddd;
            padding: 10px;
            background: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .line-login-btn {
            background: #06C755;
            color: white;
            padding: 14px 20px;
            border-radius: 10px;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin: 12px 0;
            cursor: pointer;
            font-family: 'Sarabun', sans-serif;
            font-size: 1.1rem;
            box-shadow: 0 4px 15px rgba(6, 199, 85, 0.3);
            transition: all 0.3s ease;
        }

        .line-login-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(6, 199, 85, 0.4);
        }

        .line-login-btn img {
            width: 24px;
            height: 24px;
        }

        .redirect-uri-box {
            background: rgba(255, 243, 205, 0.8);
            padding: 15px;
            border-radius: 10px;
            margin: 12px 0;
            word-break: break-all;
            font-size: 1rem;
            backdrop-filter: blur(5px);
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
            100% { transform: translateY(0px); }
        }

        .cute-float {
            animation: float 3s ease-in-out infinite;
        }

        .thai-text {
            line-height: 1.8;
            letter-spacing: 0.5px;
            font-size: 1rem;
        }

        .cute-light {
            position: absolute;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0) 70%);
            border-radius: 50%;
            pointer-events: none;
            animation: moveLight 15s infinite alternate ease-in-out;
            z-index: -1;
        }

        @keyframes moveLight {
            0% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(200px, 150px) scale(1.2); }
            50% { transform: translate(400px, 50px) scale(0.8); }
            75% { transform: translate(600px, 200px) scale(1.1); }
            100% { transform: translate(800px, 100px) scale(1); }
        }

        .webhook-instructions {
            background: rgba(255, 245, 245, 0.9);
            padding: 20px;
            border-radius: 15px;
            margin: 15px 0;
            text-align: left;
            font-size: 1rem;
            backdrop-filter: blur(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border-left: 5px solid #ff6666;
        }
        
        .webhook-steps {
            padding-left: 20px;
        }
        
        .webhook-steps li {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .webhook-image {
            text-align: center;
            margin: 15px 0;
        }
        
        .webhook-image img {
            max-width: 100%;
            border: 1px solid #ddd;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .highlight {
            background-color: #ffff00;
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            * {
                font-size: 16px;
            }
            
            .header-content h1 {
                font-size: 1.8rem;
            }
            
            nav {
                flex-wrap: nowrap;
                overflow-x: auto;
                padding: 10px;
                justify-content: flex-start;
            }
            
            nav button {
                padding: 12px 18px;
                font-size: 1rem;
                white-space: nowrap;
                flex-shrink: 0;
            }
            
            .box {
                padding: 20px;
                width: 95%;
            }
            
            input, select, button, textarea {
                font-size: 16px;
                padding: 14px;
                width: 95%;
            }
            
            .cute-light {
                display: none;
            }
            
            .admin-panel {
                position: relative;
                right: auto;
                top: auto;
                margin-top: 10px;
                justify-content: center;
                width: 100%;
            }
            
            .admin-panel button {
                margin: 5px;
                padding: 10px 15px;
            }
            
            header {
                flex-direction: column;
                padding: 15px;
            }
            
            .header-content {
                width: 100%;
            }
            
            .mobile-menu-btn {
                display: none !important;
            }
            
            .overlay {
                display: none !important;
            }
        }

        @media (max-width: 480px) {
            * {
                font-size: 15px;
            }
            
            .header-content h1 {
                font-size: 1.6rem;
            }
            
            nav button {
                padding: 10px 14px;
                margin: 3px;
                font-size: 0.9rem;
            }
            
            .box {
                padding: 15px;
                margin: 15px auto;
            }
            
            .admin-panel {
                flex-direction: column;
            }
            
            .logout-btn {
                margin-left: 0;
                margin-top: 5px;
            }
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            animation: floatParticle 15s infinite linear;
        }

        @keyframes floatParticle {
            0% {
                transform: translateY(0) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) translateX(100px) rotate(360deg);
                opacity: 0;
            }
        }

        .ribbon {
            position: absolute;
            top: 20px;
            right: -40px;
            transform: rotate(45deg);
            background: linear-gradient(45deg, #ff9ecb, #ff6666);
            color: white;
            padding: 5px 40px;
            font-size: 0.8rem;
            font-weight: bold;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 10;
        }

        .quick-login {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .quick-login-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            font-size: 24px;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>
    
    <!-- ปุ่มล็อกอินด่วน -->
    <div class="quick-login">
        <button class="quick-login-btn" onclick="quickLogin()">🔑</button>
    </div>

    <header>
        <div class="admin-panel">
            <button id="loginBtn" class="login-btn" onclick="loginWithLine()">
                <span class="line-icon">L</span> ล็อคอินสำหรับเจ้าของร้าน
            </button>
            <div id="adminMenu" class="admin-only">
                <button onclick="showPage('manage')">จัดการร้าน</button>
                <button class="logout-btn" onclick="logout()">ล็อกเอาท์</button>
            </div>
        </div>
        
        <div class="header-content">
            <h1 class="cute-float">ร้านเสริมสวยมุกซาลอน ยินดีให้บริการค่ะ</h1>
        </div>
    </header>
    
    <nav id="mainNav">
        <button class="active" onclick="showPage('home')">หน้าหลัก</button>
        <button onclick="showPage('booking')">จองคิว</button>
        <button onclick="showPage('promo')">โปรโมชัน</button>
        <button onclick="showPage('reviews')">รีวิว</button>
    </nav>

    <div class="container">
        <!-- หน้า Home -->
        <div id="home" class="page activePage">
            <div class="box">
                <h2>บริการของทางร้าน</h2>
                <ul id="servicesList"></ul>
                <div class="admin-only">
                    <h3>จัดการบริการ</h3>
                    <input type="text" id="newServiceName" placeholder="ชื่อบริการ">
                    <input type="text" id="newServicePrice" placeholder="ราคา">
                    <button onclick="addService()">เพิ่มบริการ</button>
                </div>

                <h3>วันหยุดของร้าน</h3>
                <ul id="holidayList"></ul>
                <div class="admin-only">
                    <input type="date" id="newHoliday">
                    <button onclick="addHoliday()">เพิ่มวันหยุด</button>
                </div>
            </div>
        </div>

        <!-- หน้าโปรโมชัน -->
        <div id="promo" class="page">
            <div class="box">
                <h2>โปรโมชั่น</h2>
                <div id="promoContent"></div>

                <div class="admin-only">
                    <h3>จัดการโปรโมชัน</h3>
                    <input type="text" id="promoTitle" placeholder="หัวข้อโปรโมชัน">
                    <textarea id="promoDescription" placeholder="รายละเอียดโปรโมชัน" rows="3"></textarea>
                    <input type="file" id="promoImageFile" accept="image/*">
                    <button onclick="addPromo()">เพิ่มโปรโมชัน</button>
                </div>
            </div>
        </div>

        <!-- หน้า Booking -->
        <div id="booking" class="page">
            <div class="box" id="formBox">
                <h2>กรอกข้อมูลลูกค้า</h2>
                <input type="text" id="name" placeholder="ชื่อของคุณ">
                <input type="tel" id="phone" placeholder="เบอร์โทรศัพท์">
                <button onclick="goToCalendar()">ยืนยัน</button>
            </div>

            <div class="box" id="calendarBox" style="display:none;">
                <h2>เลือกวันและเวลา</h2>
                <input type="date" id="date">
                <select id="time"></select>
                <button onclick="reviewBooking()">ถัดไป</button>
            </div>

            <div class="box" id="confirmBox" style="display:none;">
                <h2>ข้อมูลการจอง</h2>
                <p id="bookingInfo"></p>
                <button onclick="lockBooking()">ยืนยันการจอง</button>
                <button onclick="editBooking()">แก้ไข</button>
                <button onclick="cancelBooking()">ยกเลิกการจอง</button>
            </div>
        </div>

        <!-- หน้ารีวิว -->
        <div id="reviews" class="page">
            <div class="box">
                <h2>รีวิวจากลูกค้า</h2>
                <div id="reviewsList"></div>
            </div>
        </div>

        <!-- หน้าจัดการร้าน -->
        <div id="manage" class="page">
            <div class="box">
                <h2>จัดการร้าน</h2>
                <button onclick="showPage('home')">จัดการบริการและวันหยุด</button>
                <button onclick="showPage('promo')">จัดการโปรโมชัน</button>

                <div class="box">
                    <h2>จัดการพื้นหลังร้าน</h2>
                    <input type="file" id="bgUpload" accept="image/*" style="display: none;" onchange="uploadBackground(event)">
                    <button onclick="document.getElementById('bgUpload').click()">อัปโหลดพื้นหลังใหม่</button>
                    <button onclick="removeBackground()" class="delete-btn">ลบพื้นหลัง</button>
                </div>

                <div class="box">
                    <h2>ตั้งค่าแจ้งเตือน LINE</h2>
                    <div class="line-config">
                        <div class="instructions">
                            <h3>ขั้นตอนการตั้งค่า LINE Messaging API</h3>
                            <ol>
                                <li>ไปที่ <a href="https://developers.line.biz/console/" target="_blank">LINE Developers Console</a></li>
                                <li>สร้าง Provider และ Channel (เลือกประเภท Messaging API)</li>
                                <li>ไปที่แท็บ "Messaging API"</li>
                                <li>คัดลอก "Channel Access Token" วางในช่องด้านล่าง</li>
                                <li>เปิดใช้งาน Webhook</li>
                            </ol>
                        </div>

                        <div class="config-section">
                            <label for="lineChannelToken">Channel Access Token:</label>
                            <input type="password" id="lineChannelToken" placeholder="ใส่ Channel Access Token" style="width: 100%;">
                        </div>

                        <div class="config-section">
                            <label for="lineUserId">User ID ของคุณ:</label>
                            <input type="text" id="lineUserId" placeholder="ใส่ User ID ของคุณ" style="width: 100%;">
                            <p style="font-size: 0.9rem; color: #666; margin-top: 5px;">
                                หมายเหตุ: User ID สามารถหาได้โดยการส่งข้อความไปยัง LINE Official Account ของคุณ 
                                แล้วดูจากเว็บฮุค (Webhook) ใน LINE Developers Console
                            </p>
                        </div>

                        <button onclick="saveLineConfig()">บันทึกการตั้งค่า</button>
                        <button onclick="testLineConnection()" style="background: #2196F3;">ทดสอบการเชื่อมต่อ</button>

                        <div id="testResult" class="test-result"></div>
                    </div>
                </div>

                <h3>การจองล่าสุด</h3>
                <div id="bookingList"></div>
            </div>
        </div>
    </div>

    <!-- Modal สำหรับรีวิว -->
    <div class="review-modal" id="reviewModal">
        <div class="review-modal-content">
            <h2>รีวิวการใช้บริการ</h2>
            <input type="text" id="reviewerName" placeholder="ชื่อของคุณ (ไม่จำเป็น)">
            <div class="stars" id="modalStars">
                <span onclick="setModalRating(1)">★</span>
                <span onclick="setModalRating(2)">★</span>
                <span onclick="setModalRating(3)">★</span>
                <span onclick="setModalRating(4)">★</span>
                <span onclick="setModalRating(5)">★</span>
            </div>
            <textarea id="reviewComment" placeholder="ความคิดเห็น (ไม่จำเป็น)" rows="3"></textarea>
            <button onclick="submitReview()">ส่งรีวิว</button>
            <p id="thanksMsg"></p>
        </div>
    </div>

    <script>
        // ตัวแปร global
        let booking = {};
        let bookingLocked = false;
        let currentRating = 0;
        let isLoggedIn = localStorage.getItem('isLoggedIn') === 'true' || false;
        let holidays = JSON.parse(localStorage.getItem('holidays')) || ["2025-09-01", "2025-09-10"];
        let services = JSON.parse(localStorage.getItem('services')) || [
            "สระ - ไดร์ ผมตรง 60-150 บาท",
            "สระ - ไดร์ หนีบ 80-150 บาท",
            "สระผม - เด็กนักเรียน 20-80 บาท",
            "สปานาโน เริ่มต้นที่ 399 บาท"
        ];
        let promotions = JSON.parse(localStorage.getItem('promotions')) || [];
        let reviews = JSON.parse(localStorage.getItem('reviews')) || [];
        let bookings = JSON.parse(localStorage.getItem('bookings')) || [];

        // ข้อมูลการตั้งค่า LINE
        let lineConfig = JSON.parse(localStorage.getItem('lineConfig')) || {
            channelToken: '',
            userId: ''
        };

        // ฟังก์ชันล็อกอินด่วน
        function quickLogin() {
            const password = prompt("กรุณากรอกรหัสผ่านสำหรับเจ้าของร้าน");
            if (password === "muksalon157") {
                isLoggedIn = true;
                updateLoginUI();
                localStorage.setItem('isLoggedIn', 'true');
                alert("ล็อคอินสำเร็จในฐานะเจ้าของร้าน");
                showPage('manage');
            } else {
                alert("รหัสผ่านไม่ถูกต้อง");
            }
        }

        // ฟังก์ชันล็อคอินสำหรับเจ้าของร้าน
        function loginWithLine() {
            const password = prompt("กรุณากรอกรหัสผ่านสำหรับเจ้าของร้าน");
            
            if (password === "muksalon157") {
                isLoggedIn = true;
                updateLoginUI();
                localStorage.setItem('isLoggedIn', 'true');
                alert("ล็อคอินสำเร็จในฐานะเจ้าของร้าน");
                
                // โหลดการตั้งค่า LINE ที่บันทึกไว้
                document.getElementById('lineChannelToken').value = lineConfig.channelToken || '';
                document.getElementById('lineUserId').value = lineConfig.userId || '';
            } else {
                alert("รหัสผ่านไม่ถูกต้อง");
            }
        }

        // ฟังก์ชันอัพเดต UI หลังจากล็อกอิน
        function updateLoginUI() {
            if (isLoggedIn) {
                document.body.classList.add('logged-in');
                document.getElementById('loginBtn').style.display = 'none';
                document.getElementById('adminMenu').style.display = 'flex';
            } else {
                document.body.classList.remove('logged-in');
                document.getElementById('loginBtn').style.display = 'flex';
                document.getElementById('adminMenu').style.display = 'none';
            }
        }

        // ฟังก์ชันล็อกเอาท์
        function logout() {
            isLoggedIn = false;
            updateLoginUI();
            localStorage.setItem('isLoggedIn', 'false');
            alert("ล็อกเอาท์เรียบร้อย");
            showPage('home');
        }

        // ฟังก์ชันแสดงหน้า
        function showPage(page) {
            document.querySelectorAll(".page").forEach(p => p.classList.remove("activePage"));
            document.getElementById(page).classList.add("activePage");
            document.querySelectorAll("nav button").forEach(b => b.classList.remove("active"));

            const navButtons = document.querySelectorAll("nav button");
            for (let btn of navButtons) {
                if (btn.textContent === "หน้าหลัก" && page === "home") btn.classList.add("active");
                if (btn.textContent === "จองคิว" && page === "booking") btn.classList.add("active");
                if (btn.textContent === "โปรโมชัน" && page === "promo") btn.classList.add("active");
                if (btn.textContent === "รีวิว" && page === "reviews") btn.classList.add("active");
            }

            if (page === "booking") resetBookingForm();
            if (page === "home") {
                renderHolidays();
                renderServices();
            }
            if (page === "promo") renderPromotions();
            if (page === "reviews") renderReviews();
            if (page === "manage") renderBookings();
        }

        // ฟังก์ชันบันทึกการตั้งค่า LINE
        function saveLineConfig() {
            lineConfig.channelToken = document.getElementById('lineChannelToken').value;
            lineConfig.userId = document.getElementById('lineUserId').value;

            localStorage.setItem('lineConfig', JSON.stringify(lineConfig));
            alert('บันทึกการตั้งค่า LINE เรียบร้อยแล้ว');
        }

        // ฟังก์ชันทดสอบการเชื่อมต่อ LINE
        function testLineConnection() {
            if (!lineConfig.channelToken || !lineConfig.userId) {
                alert('กรุณากรอก Channel Access Token และ User ID ให้ครบถ้วน');
                return;
            }

            const testResult = document.getElementById('testResult');
            testResult.style.display = 'block';
            testResult.className = 'test-result';
            testResult.innerHTML = 'กำลังทดสอบการเชื่อมต่อ...';

            sendLineNotification("🔔 ทดสอบการแจ้งเตือนจากร้านเสริมสวยมุกซาลอน\nระบบแจ้งเตือนทำงานปกติแล้ว")
                .then((success) => {
                    if (success) {
                        testResult.classList.add('success');
                        testResult.innerHTML = '✅ การทดสอบสำเร็จ! ควรมีข้อความแจ้งเตือนไปยัง LINE ของคุณแล้ว';
                    } else {
                        testResult.classList.add('error');
                        testResult.innerHTML = '❌ การทดสอบล้มเหลว: ไม่สามารถส่งข้อความได้';
                    }
                })
                .catch(error => {
                    testResult.classList.add('error');
                    testResult.innerHTML = '❌ การทดสอบล้มเหลว: ' + error;
                });
        }

        // ฟังก์ชันส่งการแจ้งเตือนผ่าน LINE
        async function sendLineNotification(message) {
            if (!lineConfig.channelToken || !lineConfig.userId) {
                console.warn("ไม่ได้ตั้งค่า LINE Messaging API - ข้ามการส่งการแจ้งเตือน");
                return false;
            }

            try {
                const response = await fetch("https://api.line.me/v2/bot/message/push", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": "Bearer " + lineConfig.channelToken
                    },
                    body: JSON.stringify({
                        to: lineConfig.userId,
                        messages: [{
                            type: "text",
                            text: message
                        }]
                    })
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`LINE API error: ${response.status} - ${errorText}`);
                }

                console.log("ส่งข้อความผ่าน LINE สำเร็จ");
                return true;
            } catch (error) {
                console.error("เกิดข้อผิดพลาดในการส่งข้อความผ่าน LINE:", error);
                return false;
            }
        }

        // ฟังก์ชันรีเซ็ตฟอร์มจอง
        function resetBookingForm() {
            booking = {};
            bookingLocked = false;
            document.querySelectorAll("#booking .box").forEach(b => b.style.display = "none");
            document.getElementById("formBox").style.display = "block";
            document.getElementById("name").value = "";
            document.getElementById("phone").value = "";
            document.getElementById("date").value = "";
            
            // เตรียมตัวเลือกเวลา
            const timeSelect = document.getElementById("time");
            timeSelect.innerHTML = "";
            for (let h = 8; h <= 20; h++) {
                let option = document.createElement("option");
                option.value = `${h}:00`;
                option.textContent = `${h}:00`;
                timeSelect.appendChild(option);
            }
        }

        // ฟังก์ชันไปยังหน้าปฏิทิน
        function goToCalendar() {
            booking.name = document.getElementById("name").value;
            booking.phone = document.getElementById("phone").value;
            if (!booking.name || !booking.phone) {
                alert("กรุณากรอกข้อมูลให้ครบ");
                return;
            }
            document.getElementById("formBox").style.display = "none";
            document.getElementById("calendarBox").style.display = "block";
        }

        // ฟังก์ชันตรวจสอบการจอง
        function reviewBooking() {
            booking.date = document.getElementById("date").value;
            booking.time = document.getElementById("time").value;
            if (!booking.date || !booking.time) {
                alert("กรุณาเลือกวันและเวลา");
                return;
            }
            if (holidays.includes(booking.date)) {
                alert("วันดังกล่าวร้านปิด กรุณาเลือกวันอื่น");
                return;
            }
            document.getElementById("calendarBox").style.display = "none";
            document.getElementById("confirmBox").style.display = "block";
            document.getElementById("bookingInfo").innerText = `คุณ ${booking.name} เบอร์ ${booking.phone}\nวันที่ ${booking.date} เวลา ${booking.time}`;
        }

        // ฟังก์ชันยืนยันการจอง
        function lockBooking() {
            if (bookingLocked) return;
            bookingLocked = true;
            document.getElementById("confirmBox").innerHTML = `<p class="message">ลูกค้าได้จองเรียบร้อยแล้ว ขอบคุณค่ะ</p>`;

            // บันทึกการจอง
            const newBooking = {
                name: booking.name,
                phone: booking.phone,
                date: booking.date,
                time: booking.time,
                timestamp: new Date().toISOString()
            };
            bookings.push(newBooking);
            localStorage.setItem('bookings', JSON.stringify(bookings));

            // ส่งการแจ้งเตือนผ่าน LINE
            const bookingMessage = `✅ จองคิวใหม่จากเว็บไซต์
ชื่อ: ${booking.name}
เบอร์โทร: ${booking.phone}
วันที่: ${booking.date}
เวลา: ${booking.time}`;

            sendLineNotification(bookingMessage)
                .then(success => {
                    if (success) {
                        console.log("ส่งการแจ้งเตือนการจองคิวผ่าน LINE สำเร็จ");
                    } else {
                        console.warn("ไม่สามารถส่งการแจ้งเตือนผ่าน LINE ได้");
                    }
                });

            // หลังจากจองสำเร็จ ให้แสดงฟอร์มรีวิว
            setTimeout(() => {
                showReviewModal();
            }, 1500);
        }

        // ฟังก์ชันแก้ไขการจอง
        function editBooking() {
            if (bookingLocked) {
                alert("ไม่สามารถแก้ไขได้ เนื่องจากยืนยันการจองแล้ว");
                return;
            }
            document.getElementById("confirmBox").style.display = "none";
            document.getElementById("calendarBox").style.display = "block";
        }

        // ฟังก์ชันยกเลิกการจอง
        function cancelBooking() {
            document.getElementById("confirmBox").innerHTML = `<p class="message">ลูกค้าได้ยกเลิกการจองเรียบร้อยแล้ว ขอบคุณค่ะ</p>`;

            // ส่งการแจ้งเตือนการยกเลิกผ่าน LINE
            const cancelMessage = `❌ ยกเลิกการจอง
ชื่อ: ${booking.name}
เบอร์โทร: ${booking.phone}
วันที่: ${booking.date}
เวลา: ${booking.time}`;

            sendLineNotification(cancelMessage)
                .then(success => {
                    if (success) {
                        console.log("ส่งการแจ้งเตือนการยกเลิกการจองผ่าน LINE สำเร็จ");
                    } else {
                        console.warn("ไม่สามารถส่งการแจ้งเตือนผ่าน LINE ได้");
                    }
                });

            setTimeout(() => {
                showPage("home");
            }, 2000);
        }

        // ฟังก์ชันตั้งค่าคะแนนรีวิวใน modal
        function setModalRating(stars) {
            currentRating = stars;
            document.querySelectorAll("#modalStars span").forEach((s, i) => {
                s.classList.toggle("active", i < stars);
            });
        }

        // ฟังก์ชันแสดง modal รีวิв
        function showReviewModal() {
            const modal = document.getElementById("reviewModal");
            modal.style.display = "flex";

            // รีเซ็ตฟอร์มรีวิว
            document.getElementById("reviewerName").value = "";
            document.getElementById("reviewComment").value = "";
            currentRating = 0;
            document.querySelectorAll("#modalStars span").forEach(s => {
                s.classList.remove("active");
            });
            document.getElementById("thanksMsg").innerText = "";
        }

        // ฟังก์ชันปิด modal รีวิว
        function closeReviewModal() {
            document.getElementById("reviewModal").style.display = "none";
        }

        // ฟังก์ชันส่งรีวิว
        function submitReview() {
            const reviewerName = document.getElementById("reviewerName").value || "ไม่ระบุชื่อ";
            const comment = document.getElementById("reviewComment").value;

            if (currentRating === 0) {
                alert("กรุณาให้คะแนนดาวก่อนส่งรีวิว");
                return;
            }

            // บันทึกรีวิว
            reviews.push({
                name: reviewerName,
                rating: currentRating,
                comment: comment,
                date: new Date().toLocaleDateString('th-TH')
            });
            localStorage.setItem('reviews', JSON.stringify(reviews));

            document.getElementById("thanksMsg").innerText = "ขอบคุณค่ะสำหรับการรีวิว";

            // ปิด modal หลังจาก 3 วินาที
            setTimeout(() => {
                closeReviewModal();
                showPage("home");
            }, 3000);
        }

        // ฟังก์ชันแสดงวันหยุด
        function renderHolidays() {
            const ul = document.getElementById("holidayList");
            ul.innerHTML = "";
            
            if (holidays.length === 0) {
                ul.innerHTML = "<li>ไม่มีวันหยุด</li>";
                return;
            }
            
            holidays.forEach((day, index) => {
                let li = document.createElement("li");
                li.className = "holiday-item";

                let span = document.createElement("span");
                span.textContent = day;

                li.appendChild(span);
                
                // เฉพาะเจ้าของร้านเท่านั้นที่เห็นปุ่มลบ
                if (isLoggedIn) {
                    let deleteBtn = document.createElement("button");
                    deleteBtn.textContent = "ลบ";
                    deleteBtn.className = "delete-btn";
                    deleteBtn.onclick = function () { deleteHoliday(index); };
                    li.appendChild(deleteBtn);
                }
                
                ul.appendChild(li);
            });
        }

        // ฟังก์ชันแสดงบริการ
        function renderServices() {
            const ul = document.getElementById("servicesList");
            ul.innerHTML = "";
            
            if (services.length === 0) {
                ul.innerHTML = "<li>ไม่มีบริการ</li>";
                return;
            }
            
            services.forEach((service, index) => {
                let li = document.createElement("li");
                li.className = "service-item";

                let span = document.createElement("span");
                span.textContent = service;

                li.appendChild(span);
                
                // เฉพาะเจ้าของร้านเท่านั้นที่เห็นปุ่มลบ
                if (isLoggedIn) {
                    let deleteBtn = document.createElement("button");
                    deleteBtn.textContent = "ลบ";
                    deleteBtn.className = "delete-btn";
                    deleteBtn.onclick = function () { deleteService(index); };
                    li.appendChild(deleteBtn);
                }
                
                ul.appendChild(li);
            });
        }

        // ฟังก์ชันเพิ่มบริการ
        function addService() {
            const name = document.getElementById("newServiceName").value;
            const price = document.getElementById("newServicePrice").value;

            if (!name || !price) {
                alert("กรุณากรอกชื่อบริการและราคา");
                return;
            }

            services.push(`${name} ${price} บาท`);
            localStorage.setItem('services', JSON.stringify(services));

            document.getElementById("newServiceName").value = "";
            document.getElementById("newServicePrice").value = "";

            renderServices();
            alert("เพิ่มบริการเรียบร้อยแล้ว");
        }

        // ฟังก์ชันลบบริการ
        function deleteService(index) {
            if (!isLoggedIn) {
                alert("กรุณาล็อคอินก่อนลบข้อมูล");
                return;
            }

            if (confirm("คุณแน่ใจว่าต้องการลบบริการนี้?")) {
                services.splice(index, 1);
                localStorage.setItem('services', JSON.stringify(services));
                renderServices();
                alert("ลบบริการเรียบร้อยแล้ว");
            }
        }

        // ฟังก์ชันเพิ่มวันหยุด
        function addHoliday() {
            const newHoliday = document.getElementById("newHoliday").value;
            if (!newHoliday) {
                alert("กรุณาเลือกวันที่");
                return;
            }

            holidays.push(newHoliday);
            localStorage.setItem('holidays', JSON.stringify(holidays));

            document.getElementById("newHoliday").value = "";
            renderHolidays();
            alert("เพิ่มวันหยุดเรียบร้อยแล้ว");
        }

        // ฟังก์ชันลบวันหยุด
        function deleteHoliday(index) {
            if (!isLoggedIn) {
                alert("กรุณาล็อคอินก่อนลบข้อมูล");
                return;
            }

            if (confirm("คุณแน่ใจว่าต้องการลบวันหยุดนี้?")) {
                holidays.splice(index, 1);
                localStorage.setItem('holidays', JSON.stringify(holidays));
                renderHolidays();
                alert("ลบวันหยุดเรียบร้อยแล้ว");
            }
        }

        // ฟังก์ชันแสดงโปรโมชัน
        function renderPromotions() {
            const container = document.getElementById("promoContent");
            container.innerHTML = "";

            if (promotions.length === 0) {
                container.innerHTML = "<p>ยังไม่มีโปรโมชัน</p>";
                return;
            }

            promotions.forEach((promo, index) => {
                const promoDiv = document.createElement("div");
                promoDiv.className = "promo-item";

                const promoContent = document.createElement("div");
                promoContent.innerHTML = `
                    <h3>${promo.title}</h3>
                    <p>${promo.description}</p>
                    ${promo.image ? `<img src="${promo.image}" alt="${promo.title}" style="max-width: 100%;">` : ''}
                `;

                promoDiv.appendChild(promoContent);
                
                // เฉพาะเจ้าของร้านเท่านั้นที่เห็นปุ่มลบ
                if (isLoggedIn) {
                    const deleteBtn = document.createElement("button");
                    deleteBtn.textContent = "ลบโปรโมชัน";
                    deleteBtn.className = "delete-btn";
                    deleteBtn.onclick = function () { deletePromo(index); };
                    promoDiv.appendChild(deleteBtn);
                }
                
                container.appendChild(promoDiv);
            });
        }

        // ฟังก์ชันเพิ่มโปรโมชัน
        function addPromo() {
            const title = document.getElementById("promoTitle").value;
            const description = document.getElementById("promoDescription").value;
            const fileInput = document.getElementById("promoImageFile");
            const file = fileInput.files[0];

            if (!title || !description) {
                alert("กรุณากรอกหัวข้อและรายละเอียดโปรโมชัน");
                return;
            }

            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    promotions.push({ title, description, image: e.target.result });
                    localStorage.setItem('promotions', JSON.stringify(promotions));
                    resetPromoForm();
                    renderPromotions();
                    alert("เพิ่มโปรโมชันเรียบร้อยแล้ว");
                };
                reader.readAsDataURL(file); // แปลงรูปเป็น Base64
            } else {
                promotions.push({ title, description, image: "" });
                localStorage.setItem('promotions', JSON.stringify(promotions));
                resetPromoForm();
                renderPromotions();
                alert("เพิ่มโปรโมชันเรียบร้อยแล้ว");
            }
        }

        // ฟังก์ชันลบโปรโมชัน
        function deletePromo(index) {
            if (!isLoggedIn) {
                alert("กรุณาล็อคอินก่อนลบข้อมูล");
                return;
            }

            if (confirm("คุณแน่ใจว่าต้องการลบโปรโมชันนี้?")) {
                promotions.splice(index, 1);
                localStorage.setItem('promotions', JSON.stringify(promotions));
                renderPromotions();
                alert("ลบโปรโมชันเรียบร้อยแล้ว");
            }
        }

        // รีเซ็ตฟอร์มโปรโมชัน
        function resetPromoForm() {
            document.getElementById("promoTitle").value = "";
            document.getElementById("promoDescription").value = "";
            document.getElementById("promoImageFile").value = "";
        }

        // ฟังก์ชันแสดงรีวิว
        function renderReviews() {
            const container = document.getElementById("reviewsList");
            container.innerHTML = "";

            if (reviews.length === 0) {
                container.innerHTML = "<p>ยังไม่มีรีวิว</p>";
                return;
            }

            // เรียงรีวิวจากล่าสุดไปเก่าสุด
            const sortedReviews = [...reviews].reverse();

            sortedReviews.forEach((review, index) => {
                const reviewDiv = document.createElement("div");
                reviewDiv.className = "review-item";

                let stars = "";
                for (let i = 0; i < 5; i++) {
                    stars += i < review.rating ? "★" : "☆";
                }

                reviewDiv.innerHTML = `
                    <div class="review-name">${review.name}</div>
                    <div class="review-stars">${stars}</div>
                    <div>${review.comment || "ไม่มีคำอธิบาย"}</div>
                    <div style="font-size: 12px; color: #777;">${review.date}</div>
                `;

                // เพิ่มปุ่มลบสำหรับเจ้าของร้าน
                if (isLoggedIn) {
                    const deleteBtn = document.createElement("button");
                    deleteBtn.textContent = "ลบรีวิว";
                    deleteBtn.className = "delete-btn";
                    deleteBtn.onclick = function () {
                        // คำนวณดัชนีที่ถูกต้องเนื่องจากเรียงลำดับใหม่
                        const actualIndex = reviews.length - 1 - index;
                        deleteReview(actualIndex);
                    };
                    reviewDiv.appendChild(deleteBtn);
                }

                container.appendChild(reviewDiv);
            });
        }

        // ฟังก์ชันลบรีวิว
        function deleteReview(index) {
            if (!isLoggedIn) {
                alert("กรุณาล็อคอินก่อนลบข้อมูล");
                return;
            }

            if (confirm("คุณแน่ใจว่าต้องการลบรีวิวนี้?")) {
                reviews.splice(index, 1);
                localStorage.setItem('reviews', JSON.stringify(reviews));
                renderReviews();
                alert("ลบรีวิวเรียบร้อยแล้ว");
            }
        }

        // ฟังก์ชันแสดงการจอง
        function renderBookings() {
            const container = document.getElementById("bookingList");
            container.innerHTML = "";

            if (bookings.length === 0) {
                container.innerHTML = "<p>ยังไม่มีรายการจอง</p>";
                return;
            }

            // เรียงการจองจากล่าสุดไปเก่าสุด
            const sortedBookings = [...bookings].reverse();

            sortedBookings.forEach((booking, index) => {
                const bookingDiv = document.createElement("div");
                bookingDiv.className = "booking-item";

                bookingDiv.innerHTML = `
                    <p><strong>ชื่อ:</strong> ${booking.name}</p>
                    <p><strong>โทร:</strong> ${booking.phone}</p>
                    <p><strong>วันที่:</strong> ${booking.date}</p>
                    <p><strong>เวลา:</strong> ${booking.time}</p>
                    <p><strong>จองเมื่อ:</strong> ${new Date(booking.timestamp).toLocaleString('th-TH')}</p>
                `;

                // เพิ่มปุ่มลบสำหรับเจ้าของร้าน
                if (isLoggedIn) {
                    const deleteBtn = document.createElement("button");
                    deleteBtn.textContent = "ลบการจอง";
                    deleteBtn.className = "delete-btn";
                    deleteBtn.onclick = function () {
                        // คำนวณดัชนีที่ถูกต้องเนื่องจากเรียงลำดับใหม่
                        const actualIndex = bookings.length - 1 - index;
                        deleteBooking(actualIndex);
                    };
                    bookingDiv.appendChild(deleteBtn);
                }

                container.appendChild(bookingDiv);
            });
        }

        // ฟังก์ชันลบการจอง
        function deleteBooking(index) {
            if (!isLoggedIn) {
                alert("กรุณาล็อคอินก่อนลบข้อมูล");
                return;
            }

            if (confirm("คุณแน่ใจว่าต้องการลบการจองนี้?")) {
                bookings.splice(index, 1);
                localStorage.setItem('bookings', JSON.stringify(bookings));
                renderBookings();
                alert("ลบการจองเรียบร้อยแล้ว");
            }
        }

        // ฟังก์ชั่นอัปโหลดพื้นหลัง
        function uploadBackground(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    localStorage.setItem('backgroundImage', e.target.result);
                    document.body.style.backgroundImage = `url(${e.target.result})`;
                    alert("อัปโหลดพื้นหลังสำเร็จ");
                };
                reader.readAsDataURL(file);
            }
        }
            

        // ฟังก์ชั่นลบพื้นหลัง
        function removeBackground() {
            localStorage.removeItem('backgroundImage');
            document.body.style.backgroundImage = '';
            alert("ลบพื้นหลังเรียบร้อยแล้ว");
        }

        // สร้างอนุภาคน่ารัก
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.width = `${Math.random() * 15 + 5}px`;
                particle.style.height = particle.style.width;
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                particle.style.animationDuration = `${Math.random() * 10 + 10}s`;
                particle.style.animationDelay = `${Math.random() * 5}s`;
                particle.style.backgroundColor = `rgba(255, 255, 255, ${Math.random() * 0.5 + 0.3})`;
                particlesContainer.appendChild(particle);
            }
        }

        // เริ่มต้นเมื่อหน้าเว็บโหลด
        window.onload = function() {
            // โหลดการตั้งค่า LINE
            document.getElementById('lineChannelToken').value = lineConfig.channelToken || '';
            document.getElementById('lineUserId').value = lineConfig.userId || '';
            
            // ล็อกอินอัตโนมัติหากเคยล็อกอินไว้
            if (isLoggedIn) {
                document.body.classList.add('logged-in');
            }
            
            // โหลดพื้นหลังที่บันทึกไว้
            const savedBg = localStorage.getItem('backgroundImage');
            if (savedBg) {
                document.body.style.backgroundImage = `url(${savedBg})`;
            }
            
            // เตรียมตัวเลือกเวลา
            const timeSelect = document.getElementById("time");
            for (let h = 8; h <= 20; h++) {
                let option = document.createElement("option");
                option.value = `${h}:00`;
                option.textContent = `${h}:00`;
                timeSelect.appendChild(option);
            }
            
            // โหลดข้อมูล
            renderHolidays();
            renderServices();
            renderPromotions();
            renderReviews();
            
            // สร้างอนุภาค
            createParticles();
            
            // เพิ่ม event listener สำหรับคลิกนอก modal เพื่อปิด
            document.getElementById("reviewModal").addEventListener("click", function (e) {
                if (e.target === this) {
                    closeReviewModal();
                    showPage("home");
                }
            });
            
            // ตรวจสอบว่าผู้ใช้ใช้มือถือหรือไม่
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                document.body.classList.add('mobile-device');
            }
        }

    </script>
</body>
</html>
